<ng-container *ngIf="vm$ | async as vm">
  <app-appbar pageName="Client"></app-appbar>
  <tui-tabs class="nav-tabs" [(activeItemIndex)]="activeItemIndex">
    <button tuiTab>Input Data</button>
    <button tuiTab>Results</button>
  </tui-tabs>
  <form
    class="client-form flex column m-start c-center gap-2"
    [formGroup]="clientForm"
    *ngIf="activeItemIndex === 0; else elseBlock">
    <tui-input tuiTextfieldSize="s" formControlName="name">
      Name
      <input tuiTextfield (blur)="onBlur()" />
    </tui-input>
    <tui-input-date
      tuiUnfinishedValidator="Finish filling the field"
      formControlName="birthdate">
      Birthdate
    </tui-input-date>
    <tui-input-number formControlName="expectedRetirementAge">
      Expected Retirement Age
    </tui-input-number>

    <tui-select formControlName="province">
      Province
      <tui-data-list-wrapper
        *tuiDataList
        [items]="provinceOptions"></tui-data-list-wrapper>
    </tui-select>

    <tui-input-number formControlName="annualIncome">
      Annual Income ($CAD)
    </tui-input-number>
    <tui-input-number formControlName="incomeReplacementMultiplier">
      Income Replacement Multiplier
    </tui-input-number>

    <tui-select formControlName="selectedBracket">
      Tax Bracket
      <tui-data-list-wrapper *tuiDataList></tui-data-list-wrapper>
    </tui-select>
  </form>
  <ng-template #elseBlock>
    <div class="gap-2 flex column">
      <app-value-card
        [value]="{
          label: 'Age',
          value: vm.client.birthdate || 'N/A'
        }"></app-value-card>
      <app-value-card
        [value]="{
          label: 'Years of Active Income',
          value: (vm.client.expectedRetirementAge || 'N/A').toString()
        }"></app-value-card>
      <app-value-card
        [value]="{
          label: 'Amount Insured for Income ($CAD)',
          value: (vm.client.annualIncome | currency) || 'N/A'
        }"></app-value-card>
    </div>
  </ng-template>
</ng-container>
